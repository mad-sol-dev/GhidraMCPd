{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "AnalyzeFunctionCompleteRequest",
  "type": "object",
  "additionalProperties": false,
  "required": ["address"],
  "properties": {
    "address": {
      "type": "string",
      "pattern": "^(0x)?[0-9a-fA-F]+$"
    },
    "fields": {
      "type": "array",
      "minItems": 1,
      "uniqueItems": true,
      "items": {
        "type": "string",
        "enum": [
          "function",
          "disasm",
          "decompile",
          "xrefs",
          "callgraph",
          "strings",
          "features"
        ]
      }
    },
    "fmt": {
      "type": "string",
      "enum": ["json"]
    },
    "max_result_tokens": {
      "type": "integer",
      "minimum": 0
    },
    "options": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "disasm": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "before": {
              "type": "integer",
              "minimum": 0,
              "maximum": 64
            },
            "after": {
              "type": "integer",
              "minimum": 0,
              "maximum": 64
            },
            "max_instructions": {
              "type": "integer",
              "minimum": 1,
              "maximum": 128
            }
          }
        },
        "xrefs": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "inbound_limit": {
              "type": "integer",
              "minimum": 0,
              "maximum": 256
            },
            "outbound_limit": {
              "type": "integer",
              "minimum": 0,
              "maximum": 256
            }
          }
        },
        "callgraph": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "limit": {
              "type": "integer",
              "minimum": 0,
              "maximum": 256
            }
          }
        },
        "strings": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "limit": {
              "type": "integer",
              "minimum": 0,
              "maximum": 64
            },
            "max_cstring_len": {
              "type": "integer",
              "minimum": 1,
              "maximum": 1024
            }
          }
        },
        "decompile": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "enabled": {
              "type": "boolean"
            },
            "max_lines": {
              "type": "integer",
              "minimum": 1,
              "maximum": 500
            }
          }
        }
      }
    }
  }
}
